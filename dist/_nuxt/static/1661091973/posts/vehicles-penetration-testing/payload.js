__NUXT_JSONP__("/posts/vehicles-penetration-testing", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){return {data:[{post:{slug:"vehicles-penetration-testing",description:"Overview of Cars Hacking, testing & Setup.",title:"Penetration Testing with Open Source",image:"\u002Fposts\u002Fpenetration-testing\u002Fcar_hacking.png",alt:t,publishedAt:"2021-08-12T00:00:00.000Z",tags:["Electronic","Testing",t],tweet:"https:\u002F\u002Ftwitter.com\u002Fchemistdev",toc:[],body:{type:"root",children:[{type:b,tag:"h1",props:{id:"automotive-penetration-testing"},children:[{type:b,tag:"a",props:{ariaHidden:"true",href:"#automotive-penetration-testing",tabIndex:-1},children:[{type:b,tag:c,props:{className:["icon","icon-link"]},children:[]}]},{type:a,value:"Automotive Penetration Testing"}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"Connected cars and its numerous interfaces are usually well-prepared to fend off cyberattacks. Automotive security in general requires identify and check vulnerabilities targets in order to derive counter-measures. Frequent vulnerabilities can be found on: "}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"* Electronic Control Units (ECU)\r\n    * HW based attacks on PCB manipulation bypass or diagnostics \r\n* Interfaces infraestructures \r\n    * Communication protocols via CAN bus or UDS network units. Media interfaces like USB, Ethernet, WiFi, Bluetooth, SD cards. \r\n* Backed of Web Applications \r\n    * SW based car Apps through 3rd party services (iOS\u002FAndroid) "}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"Internal structure of the cars have a simplified topology with CAN-Bus where every ECUs can talk to any other. In middle class cars we have gateway ECUs with separate communications CAN domains for infotainment ECUs and all for Powertrain and Engines. In most modern cars are Automotive Ethernet with gateway ECU with connections and routers to switches to change the massages routing to main controllers and subscribe data from one network to anohter through other configuration. "}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"Automotive diagnostics protocol stack are CAN based and IEEE 802.3 based networks: \r\n* CAN uses the ISO-TP to send data packets of messages that exceed 8 Bytes up to 4095 Bytes. The application used are OBD (Onboard) and UDS (Offline).\r\n* IEEE 802.3 uses the DoIP via wired Ethernet to send data covering up to 10Mbps with the same applications as CAN"}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"CAN is mainly used for exchanging process data via XML files, while IP-SD exchange process data via IP. There are many open sources tools like Nmap or Wireshark for Ethernet protocolls. In the pass, multiple car-hacking tools were available but limited, not maintainable, only supported by specific OS, not extendable due to understandable software architecture with thousands of files."}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"After checking the evolution of all the available open source tools, there are few of them based on Python that are very well documented and works for all existing OS"}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:a,value:"## Conclusion\r\nSecuring vehicles is not an easy task, but there are free Open Sources out there. If it does not work, try reverse engineering :)  "}]},{type:a,value:f},{type:b,tag:"div",props:{className:["nuxt-content-highlight"]},children:[{type:b,tag:"pre",props:{className:["language-python","line-numbers"]},children:[{type:b,tag:"code",props:{},children:[{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:p}]},{type:a,value:u},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"test_xyz_scan"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n   log_interactive"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"setLevel"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"logging"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"DEBUG"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n   keyfunction "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:a,value:" securityAccess_Algorithm0\n   s "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:a,value:" GMLAN_Scanner"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"socket"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" reset_handler"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n   xyz_CA1Enumerator_kwargs"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:"{"}]},{type:b,tag:c,props:{className:[d,x]},children:[{type:a,value:"\"keyfunction\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:" keyfunction"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:"}"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n   verborrea"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,s]},children:[{type:a,value:"True"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" timeout"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"1"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" dynamic_timeout"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,s]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n\n"},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:p}]},{type:a,value:" exploit_payload "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:a,value:" dhx"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"40"}]},{type:a,value:" f6 "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"5d"}]},{type:a,value:" ff"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:p}]},{type:a,value:u},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"test_code_execution"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:q},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"scan"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"for"}]},{type:a,value:" x "},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"in"}]},{type:a,value:" s"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"enumerators"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:"\n   x"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"show"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"get_state_paths"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n\n   "},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"if"}]},{type:a,value:" XPS_TransferPayload"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"arm_s"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" socket"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:a,value:"allnode1_s"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n    timeout"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"5"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" retry"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"2"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" verborrea"},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:h}]},{type:b,tag:c,props:{className:[d,s]},children:[{type:a,value:y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:"\n    "},{type:b,tag:c,props:{className:[d,m]},children:[{type:a,value:"print"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:b,tag:c,props:{className:[d,x]},children:[{type:a,value:"\"DONE\""}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:k}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:l,props:{},children:[{type:b,tag:"img",props:{alt:"'Arduino'",src:"https:\u002F\u002Fsource.unsplash.com\u002FdacmWVUmux4"},children:[]}]}]},dir:"\u002Fposts",path:"\u002Fposts\u002Fvehicles-penetration-testing",extension:".md",createdAt:"2021-08-12T15:35:01.212Z",updatedAt:"2021-09-29T21:41:25.171Z",readingTime:{text:"1 min read",minutes:.31,time:18600,words:62},html:"\u003Ch1 id=\"automotive-penetration-testing\"\u003EAutomotive Penetration Testing\u003C\u002Fh1\u003E\n\u003Cp\u003EConnected cars and its numerous interfaces are usually well-prepared to fend off cyberattacks. Automotive security in general requires identify and check vulnerabilities targets in order to derive counter-measures. Frequent vulnerabilities can be found on: \u003C\u002Fp\u003E\n\u003Cp\u003E* Electronic Control Units (ECU)\n    * HW based attacks on PCB manipulation bypass or diagnostics \n* Interfaces infraestructures \n    * Communication protocols via CAN bus or UDS network units. Media interfaces like USB, Ethernet, WiFi, Bluetooth, SD cards. \n* Backed of Web Applications \n    * SW based car Apps through 3rd party services (iOS\u002FAndroid) \u003C\u002Fp\u003E\n\u003Cp\u003EInternal structure of the cars have a simplified topology with CAN-Bus where every ECUs can talk to any other. In middle class cars we have gateway ECUs with separate communications CAN domains for infotainment ECUs and all for Powertrain and Engines. In most modern cars are Automotive Ethernet with gateway ECU with connections and routers to switches to change the massages routing to main controllers and subscribe data from one network to anohter through other configuration. \u003C\u002Fp\u003E\n\u003Cp\u003EAutomotive diagnostics protocol stack are CAN based and IEEE 802.3 based networks: \n* CAN uses the ISO-TP to send data packets of messages that exceed 8 Bytes up to 4095 Bytes. The application used are OBD (Onboard) and UDS (Offline).\n* IEEE 802.3 uses the DoIP via wired Ethernet to send data covering up to 10Mbps with the same applications as CAN\u003C\u002Fp\u003E\n\u003Cp\u003ECAN is mainly used for exchanging process data via XML files, while IP-SD exchange process data via IP. There are many open sources tools like Nmap or Wireshark for Ethernet protocolls. In the pass, multiple car-hacking tools were available but limited, not maintainable, only supported by specific OS, not extendable due to understandable software architecture with thousands of files.\u003C\u002Fp\u003E\n\u003Cp\u003EAfter checking the evolution of all the available open source tools, there are few of them based on Python that are very well documented and works for all existing OS\u003C\u002Fp\u003E\n\u003Ch2 id=\"conclusion\"\u003EConclusion\u003C\u002Fh2\u003E\n\u003Cp\u003ESecuring vehicles is not an easy task, but there are free Open Sources out there. If it does not work, try reverse engineering :)  \u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-python\"\u003Edef test_xyz_scan(reset_ecus, interface):\n   log_interactive.setLevel(logging.DEBUG)\n   keyfunction = securityAccess_Algorithm0\n   s = GMLAN_Scanner(socket, reset_handler=reset_ecus,\n   xyz_CA1Enumerator_kwargs={&quot;keyfunction&quot;: keyfunction},\n   verborrea=True, timeout=1, dynamic_timeout=False)\n\ndef exploit_payload = dhx(40 f6 5d ff)\ndef test_code_execution(reset_ecus, interface)\n   s.scan()\nfor x in s.enumerators:\n   x.show()\n   s.get_state_paths()\n\n   if XPS_TransferPayload(arm_s, socket=allnode1_s.\n    timeout=5, retry=2, verborrea=False)\n    print(&quot;DONE&quot;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fsource.unsplash.com\u002FdacmWVUmux4\" alt=\"&#39;Arduino&#39;\"\u003E\u003C\u002Fp\u003E\n"}}],fetch:[],mutations:void 0}}("text","element","span","token","punctuation","\n","operator","=","(",",",")","p","keyword",".","number","def","reset_ecus",":","boolean","Penetration Testing."," ","function"," interface","string","False","\n   s")));